
import java.io.FileNotFoundException;
import java.util.*;
import java.io.File;

public class Simplifier {

    static String str,str1,str2, str3, strWoArt;
    static StringBuilder str3Builder;

    public static void main(String[] args) {
        try {
            readFile();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

        step1(str);
        step2(str1);
        step3(str2);
        step4(str3Builder, str);
    }

    /**
     * This method injects text to string format
     * and shows raw data
     */
    public static void readFile() throws FileNotFoundException {  //throws FileNotFoundException

        String str0 = new Scanner(new File("readme.txt"))
                .useDelimiter("\\A").next();

        System.out.println("Original string: " + str0);

        //String str0 = "cise ck c ooo oou iee be e the a an the ttthe aa aan aaaaan ";

        str = str0.toLowerCase();
        System.out.println("Raw string:      " + str);
    }

    /**
     * This method removes "c" from the text
     */
    public static void step1(String str) {

        str1 = str.replaceAll("ci", "si")
                .replaceAll("ck", "k")
                .replaceAll("c", "k");

        System.out.println("After step1:     " + str1);
    }

    /**
     * This method removes double letters
     */
    public static void step2(String str1) {
        str2 = str1.replaceAll("ee", "i")
                .replaceAll("oo", "u")
                .replaceAll("(.)\\1+", "$1");

        System.out.println("After step 2:    " + str2);

    }

    /**
     * This method  removes letter “e” in the end of each word
     */
    public static void step3(String str2) {

        String[] words = str2.split("\\W");

        //create empty StringBuilder with same length as string
        str3Builder = new StringBuilder(str2.length());

        for (String word : words) {

            if (word.length() > 1 && word.charAt(word.length() - 1) == 'e')
                str3Builder
                        .append(word.substring(0, word.length() - 1))
                        .append(' ');
            else
                str3Builder.append(word);

            //we don't want to go beyond string length
            if (str3Builder.length() < str2.length()) {
                str3Builder.append(str2.charAt(str3Builder.length()));
            }
        }
    }


    /**
     * This method  removes articles and
     * shows final result
     */
    public static void step4(StringBuilder str3Builder, String str) {

        str3 = str3Builder.toString();

        strWoArt = str.replaceAll("\\ba\\b", "")
                .replaceAll("\\ban\\b", "")
                .replaceAll("\\bthe\\b", "");

        System.out.println("After step 3:    " + str3);
        System.out.println("Without artcls:  " + strWoArt);

        String[] words3 = str3.split("\\s+"); //("\\s+")
        String[] wordsWoArt = strWoArt.split("\\W+"); //\W+

        StringBuilder str4 = new StringBuilder(str3Builder.length());

        System.out.println("words3 length:   "+words3.length); //just in case
        System.out.println("wordsWoArt length:   " + wordsWoArt.length);


        System.out.println("strWoArt length:     " + strWoArt.length());
        int j=0;
        while(j< words3.length) {
            for (int i = 1; i < strWoArt.length(); i++) {
                if (strWoArt.charAt(i-1) != ' ' && strWoArt.charAt(i) == ' '){  //&& i<strWoArt.length()
                    str4.append(words3[j] + " ");
                    break;
                    }
                //else j++;
            }
            j++;
        }
        System.out.println("j=" + j);

        System.out.println("Final string :  " + str4); //sis k k uo u i b e th a an an thi i
    }

}
